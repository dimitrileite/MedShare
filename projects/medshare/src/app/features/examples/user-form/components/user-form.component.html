<div class="container" rtl>

  <div class="row">
    <div class="col">
      <h1 class="main-heading">{{ 'mds.examples.users.form.title' | translate }}</h1>
    </div>
  </div>

  <!--   <ng-container *ngIf="userFormValueChanges$ | async as updatedForm">
    {{update(updatedForm)}}
  </ng-container> -->

  <mat-stepper class="stepper" [orientation]="(stepperOrientation$ | async)!">

    <mat-step [stepControl]="userForm" label="Create User">
      <form [formGroup]="userForm" (ngSubmit)="onCreateUser()">
        <div class="row justify-content-center">
          <div class="col-md-8">
            <mat-card>

              <span class="d-flex justify-content-between align-items-baseline">
                <h2>{{ 'mds.examples.users.form.subtitle1' | translate }}</h2>
                <!-- <mat-slide-toggle formControlName="autosave">
                  {{ 'mds.examples.users.form.autosave' | translate }}
                </mat-slide-toggle> -->
              </span>

              <!-- Input fields -->

              <div class="row">
                <mat-form-field class="col" [ngClass]="routeAnimationsElements">
                  <input matInput placeholder="{{ 'mds.examples.users.form.placeholder.firstname' | translate }}"
                    formControlName="firstname">
                  <mat-error *ngIf="userForm.get('firstname').hasError('required')">
                    {{ 'mds.examples.users.form.placeholder.firstname' | translate }}
                    {{ 'mds.examples.users.form.error.required' | translate }}
                  </mat-error>
                  <mat-error *ngIf="userForm.get('firstname').hasError('minlength')">
                    {{'mds.examples.users.form.error.minlength' | translate:{minlength:
                    userForm.get('firstname').errors.minlength.requiredLength} }}
                  </mat-error>
                </mat-form-field>
                <mat-form-field class="col" [ngClass]="routeAnimationsElements">
                  <input matInput placeholder="{{ 'mds.examples.users.form.placeholder.lastname' | translate }}"
                    formControlName="lastname">
                  <mat-error *ngIf="userForm.get('lastname').hasError('required')">
                    {{ 'mds.examples.users.form.placeholder.lastname' | translate }}
                    {{ 'mds.examples.users.form.error.required' | translate }}
                  </mat-error>
                  <mat-error *ngIf="userForm.get('lastname').hasError('minlength')">
                    {{'mds.examples.users.form.error.minlength' | translate:{minlength:
                    userForm.get('lastname').errors.minlength.requiredLength} }}
                  </mat-error>
                  <mat-error *ngIf="userForm.get('lastname').hasError('pattern')">
                    {{'mds.examples.users.form.error.pattern' | translate}}
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="row">
                <mat-form-field class="col" [ngClass]="routeAnimationsElements">
                  <input matInput placeholder="{{ 'mds.examples.users.form.placeholder.phone' | translate }}"
                    formControlName="phone">
                  <mat-error *ngIf="userForm.get('phone').hasError('required')">
                    {{ 'mds.examples.users.form.placeholder.phone' | translate }}
                    {{ 'mds.examples.users.form.error.required' | translate }}
                  </mat-error>
                  <mat-error *ngIf="userForm.get('phone').hasError('pattern')">
                    {{'mds.examples.users.form.placeholder.phone' | translate}}
                  </mat-error>
                </mat-form-field>
                <mat-form-field class="col" [ngClass]="routeAnimationsElements">
                  <input matInput placeholder="{{ 'mds.examples.users.form.placeholder.email' | translate }}"
                    formControlName="email" type="email">
                  <mat-error *ngIf="userForm.get('email').hasError('required')">
                    {{ 'mds.examples.users.form.placeholder.email' | translate }}
                    {{ 'mds.examples.users.form.error.required' | translate }}
                  </mat-error>
                  <mat-error *ngIf="userForm.get('email').hasError('email')">
                    {{ 'mds.examples.users.form.placeholder.email' | translate }}
                    {{ 'mds.examples.users.form.error.valid' | translate }}</mat-error>
                </mat-form-field>
              </div>

              <div class="row">
                <mat-form-field class="col" [ngClass]="routeAnimationsElements">
                  <mat-label>{{'mds.examples.users.form.placeholder.gender' | translate}}</mat-label>
                  <mat-select formControlName="gender">
                    <mat-option value="male">{{'mds.examples.users.form.placeholder.male' | translate}}</mat-option>
                    <mat-option value="female">{{'mds.examples.users.form.placeholder.female' | translate}}</mat-option>
                  </mat-select>
                  <mat-error *ngIf="userForm.get('gender').hasError('required')">
                    {{'mds.examples.users.form.placeholder.gender' | translate}}
                    {{'mds.examples.users.form.error.required' | translate}}
                  </mat-error>
                </mat-form-field>
                <mat-form-field class="col" [ngClass]="routeAnimationsElements">
                  <input matInput formControlName="birthdate" [matDatepicker]="picker"
                    placeholder="{{ 'mds.examples.users.form.placeholder.birthdate' | translate }}">
                  <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                  <mat-datepicker #picker></mat-datepicker>
                  <mat-error *ngIf="userForm.get('birthdate').hasError('required')">
                    {{ 'mds.examples.users.form.placeholder.birthdate' | translate }}
                    {{ 'mds.examples.users.form.error.required' | translate }}
                  </mat-error>
                </mat-form-field>
              </div>


              <!-- Description
              <div class="row">
                <mat-form-field class="col" [ngClass]="routeAnimationsElements">
                  <textarea matInput placeholder="{{ 'mds.examples.users.form.placeholder.description' | translate }}"
                    formControlName="description" minlength="10" maxlength="1000" cdkTextareaAutosize
                    #autosize="cdkTextareaAutosize" cdkAutosizeMinRows="3" cdkAutosizeMaxRows="10"></textarea>
                  <mat-hint align="end">{{userForm.get('description').value?.length}} /
                    1000</mat-hint>
                  <mat-error *ngIf="userForm.get('description').hasError('required')">
                    {{ 'mds.examples.users.form.placeholder.description' | translate }}
                    {{ 'mds.examples.users.form.error.required' | translate }}
                  </mat-error>
                  <mat-error *ngIf="userForm.get('description').hasError('minlength')">
                    {{ 'mds.examples.users.form.placeholder.description' | translate }}
                    {{ 'mds.examples.users.form.error.minlength' | translate }} 10
                  </mat-error>
                  <mat-error *ngIf="userForm.get('description').hasError('maxlength')">
                    {{ 'mds.examples.users.form.placeholder.description' | translate }}
                    {{ 'mds.examples.users.form.error.maxlength' | translate }} 1000
                  </mat-error>
                </mat-form-field>
              </div> -->

              <!-- Rating
              <div class="row" [ngClass]="routeAnimationsElements">
                <div class="col">
                  <label>{{ 'mds.examples.users.form.text2' | translate }}</label>
                  <br>
                  <mat-slider thumbLabel tickInterval="1" min="1" max="10" formControlName="rating"></mat-slider>
                </div>
              </div> -->

              <!-- Buttons -->
              <div class="row buttons d-flex justify-content-between pad">
                <button mat-raised-button color="primary" [ngClass]="routeAnimationsElements" matStepperNext>
                  {{ 'mds.examples.users.form.next' | translate }}
                </button>
                <!-- <button type="button" mat-raised-button color="accent" [disabled]="userForm.get('autosave').value"
                  [ngClass]="routeAnimationsElements" (click)="save()">
                  {{ 'mds.examples.users.form.save' | translate }}
                </button> -->
                <button type="reset" mat-raised-button (click)="reset()" [ngClass]="routeAnimationsElements">
                  {{ 'mds.examples.users.form.reset' | translate }}
                </button>
              </div>

            </mat-card>
          </div>
        </div>
      </form>
    </mat-step>

    <mat-step [stepControl]="userForm" label="Create Wallet">
      <form [formGroup]="userForm" (ngSubmit)="onEncryptWallet()">
        <div class="row justify-content-center">
          <div class="col-md-8">
            <mat-card>
              <span class="d-flex justify-content-between align-items-baseline">
                <h2>{{ 'mds.examples.users.form.subtitle.wallet' | translate }}</h2>
                <!-- <mat-slide-toggle formControlName="autosave">
                    {{ 'mds.examples.users.form.autosave' | translate }}
                  </mat-slide-toggle> -->
              </span>
              <div class="row">
                <p>{{'mds.examples.users.form.seed' | translate}}</p>
                <mat-chip-list>
                  <mat-chip *ngFor="let word of mnemonic; let i = index" color="primary" selected>
                    {{ i + 1 }} - {{ word }}
                  </mat-chip>
                </mat-chip-list>
              </div>
              <!-- Input fields -->
              <div class="row">
                <p>{{'mds.examples.users.form.encrypt' | translate}}</p>
                <mat-form-field class="col" [ngClass]="routeAnimationsElements">
                  <input matInput type="password"
                    placeholder="{{ 'mds.examples.users.form.placeholder.password' | translate }}"
                    formControlName="newpassword">
                  <mat-error *ngIf="userForm.get('newpassword').invalid">
                    {{ 'mds.examples.users.form.placeholder.password' | translate }}
                    {{ 'mds.examples.users.form.error.required' | translate }}
                  </mat-error>
                </mat-form-field>
                <mat-form-field class="col" [ngClass]="routeAnimationsElements">
                  <input matInput type="password"
                    placeholder="{{ 'mds.examples.users.form.placeholder.confirm' | translate }}"
                    formControlName="confirmpassword">
                  <mat-error *ngIf="userForm.get('confirmpassword').invalid">
                    {{ 'mds.examples.users.form.placeholder.confirm' | translate }}
                    {{ 'mds.examples.users.form.error.required' | translate }}
                  </mat-error>
                  <mat-error *ngIf="userForm.get('confirmpassword').hasError('confirmValidator')">
                    {{'mds.examples.users.form.error.notequal' | translate}}
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="row">
                <mat-checkbox class="col" formControlName="acceptTerms" [ngClass]="routeAnimationsElements">
                  {{ 'mds.examples.users.form.accept' | translate }}
                </mat-checkbox>
              </div>

              <!-- Buttons -->
              <div class="row buttons d-flex justify-content-between pad">
                <button mat-raised-button color="primary" [ngClass]="routeAnimationsElements" matStepperNext>
                  {{ 'mds.examples.users.form.next' | translate }}
                </button>
                <button type="reset" mat-raised-button (click)="reset()" [ngClass]="routeAnimationsElements"
                  matStepperPrevious>
                  {{ 'mds.examples.users.form.previous' | translate }}
                </button>
              </div>
            </mat-card>
          </div>
        </div>
      </form>
    </mat-step>

    <!-- Second step : Validate 3 random words -->
  <mat-step [stepControl]="confirmForm" label="Confirmation">   
    <mat-card>
      <form [formGroup]="confirmForm" fxLayout="column">

        <mat-form-field *ngFor="let test of testWords; let i = index">
          <span matPrefix>{{ test.index + 1 }} &nbsp; </span>
          <input matInput placeholder="Fill" [formControlName]="i" required />
        </mat-form-field>        
        
        <div>
          <!-- <button mat-button matStepperPrevious>Back</button> -->
          <button mat-button matStepperNext>Next</button>
        </div>
      </form>
    </mat-card>
  </mat-step>

    <mat-step label="Done">
      <div class="row justify-content-center">
        <div class="col-md-8">
          <mat-card>
            <p>Well done!</p>
            <p>This is your address: {{address}}</p>
            <p>This is your balance: {{balance}}</p>
            <div>
              <button mat-raised-button color="primary" routerLink="dashboard">
                {{'mds.admin.profile.form.add.dashboard' | translate}}</button>
            </div>
          </mat-card>
        </div>
      </div>
    </mat-step>
  </mat-stepper>
</div>